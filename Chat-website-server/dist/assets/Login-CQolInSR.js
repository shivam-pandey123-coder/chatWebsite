import{j as e,r as C,u as k,b as q,a as A,S as D,V as F,_ as i,c as I,s as L,d as S}from"./index-CmQY8uF5.js";import{b as U,z as p,L as V}from"./index-s6MUvYlc.js";import{C as B}from"./Container-Bf2RFnZ5.js";import{P}from"./Modal-BScw2avD.js";import{c as E,T as s}from"./Typography-CkiNPmcL.js";import{T as o}from"./TextField-BhZ99sdC.js";import{B as x}from"./Button-B5GyiZWC.js";import{A as N}from"./Avatar-D5RUx6lz.js";import{I as R}from"./IconButton-DqD8OHsx.js";import"./isMuiElement-CutwVOsY.js";import"./Menu-o7Jrpwe1.js";const z=E([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt"),G=v=>{if(!U(v))return{isValid:!1,errorMessage:"username is invalid"}},ae=()=>{const[v,W]=C.useState(!0),[g,h]=C.useState(!1),b=()=>W(d=>!d),f=p(""),j=p(""),r=p("",G),t=p(""),l=V(),y=k(),T=async d=>{var u,m;d.preventDefault();const c=i.loading("Logging In...");h(!0);const n={withCredentials:!0,headers:{"Content-Type":"application/json"}};try{const{data:a}=await I.post(`${L}/api/v1/user/login`,{username:r.value,password:t.value},n);y(S(a.user)),i.success(a.message,{id:c})}catch(a){i.error(((m=(u=a==null?void 0:a.response)==null?void 0:u.data)==null?void 0:m.msg)||"something went wrong",{id:c})}finally{h(!1)}},H=async d=>{var u,m;d.preventDefault();const c=i.loading("Signing up...");h(!0);const n=new FormData;n.append("avatar",l.file),n.append("name",f.value),n.append("bio",j.value),n.append("username",r.value),n.append("password",t.value);try{const a={withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}},{data:w}=await I.post(`${L}/api/v1/user/new`,n,a);y(S(w.user)),i.success(w.message,{id:c})}catch(a){i.error(((m=(u=a==null?void 0:a.response)==null?void 0:u.data)==null?void 0:m.msg)||"something went wrong",{id:c})}finally{h(!0)}};return e.jsx("div",{style:{backgroundImage:q},children:e.jsx(B,{component:"main",maxWidth:"xs",sx:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(P,{elevation:3,sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",backgroundImage:A},children:v?e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"h5",children:"Login"}),e.jsxs("form",{style:{width:"100%",marginTop:"1rem"},onSubmit:T,children:[e.jsx(o,{required:!0,fullWidth:!0,label:"Username",margin:"normal",variant:"outlined",value:r.value,onChange:r.changeHandler}),e.jsx(o,{required:!0,fullWidth:!0,label:"Password",type:"password",margin:"normal",variant:"outlined",value:t.value,onChange:t.changeHandler}),e.jsx(x,{sx:{marginTop:"1rem"},variant:"contained",color:"primary",type:"submit",fullWidth:!0,disabled:g,children:"Login"}),e.jsx(s,{textAlign:"center",m:"1rem",children:"OR"}),e.jsx(x,{variant:"text",color:"secondary",fullWidth:!0,onClick:b,disabled:g,children:"Sign Up"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"h5",children:"SignUp"}),e.jsxs("form",{style:{width:"100%",marginTop:"1rem"},onSubmit:H,children:[e.jsxs(D,{position:"relative",width:"10rem",margin:"auto",children:[e.jsx(N,{sx:{width:"10rem",height:"10rem",objectFit:"contain"},src:l.preview}),e.jsx(R,{sx:{position:"absolute",bottom:"0",right:"0",color:"white",bgcolor:"rgba(0,0,0,0.5)",":hover":{bgcolor:"rgba(255,255,255,0.7)"}},component:"label",children:e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx(F,{type:"file",onChange:l.changeHandler})]})})]}),l.error&&e.jsx(s,{m:"1rem",color:"error",variant:"caption",display:"block",width:"fit-content",children:l.error}),e.jsx(o,{required:!0,fullWidth:!0,label:"Name",margin:"normal",variant:"outlined",value:f.value,onChange:f.changeHandler}),e.jsx(o,{required:!0,fullWidth:!0,label:"Bio",margin:"normal",variant:"outlined",value:j.value,onChange:j.changeHandler}),e.jsx(o,{required:!0,fullWidth:!0,label:"Username",margin:"normal",variant:"outlined",value:r.value,onChange:r.changeHandler}),r.error&&e.jsx(s,{color:"error",variant:"caption",children:r.error}),e.jsx(o,{required:!0,fullWidth:!0,label:"Password",type:"password",margin:"normal",variant:"outlined",value:t.value,onChange:t.changeHandler}),e.jsx(x,{sx:{marginTop:"1rem"},variant:"contained",color:"primary",type:"submit",fullWidth:!0,disabled:g,children:"SignUp"}),e.jsx(s,{textAlign:"center",m:"1rem",children:"OR"}),e.jsx(x,{variant:"text",color:"secondary",fullWidth:!0,onClick:b,disabled:g,children:"Login"})]})]})})})})};export{ae as default};
